"use strict";(globalThis.webpackChunkmy_website=globalThis.webpackChunkmy_website||[]).push([[8198],{7523(e,n,r){r.r(n),r.d(n,{assets:()=>o,contentTitle:()=>a,default:()=>d,frontMatter:()=>i,metadata:()=>s,toc:()=>c});const s=JSON.parse('{"id":"module-1/chapter-2-python-agents","title":"Chapter 2 - Python Agents + rclpy Integration","description":"Introduction to rclpy","source":"@site/docs/module-1/chapter-2-python-agents.md","sourceDirName":"module-1","slug":"/module-1/chapter-2-python-agents","permalink":"/docs/module-1/chapter-2-python-agents","draft":false,"unlisted":false,"editUrl":"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/module-1/chapter-2-python-agents.md","tags":[],"version":"current","frontMatter":{"id":"chapter-2-python-agents","title":"Chapter 2 - Python Agents + rclpy Integration","sidebar_label":"Python Agents + rclpy"},"sidebar":"tutorialSidebar","previous":{"title":"ROS 2 Fundamentals","permalink":"/docs/module-1/chapter-1-ros2-fundamentals"},"next":{"title":"Humanoid Robot URDF","permalink":"/docs/module-1/chapter-3-urdf-essentials"}}');var t=r(4848),l=r(8453);const i={id:"chapter-2-python-agents",title:"Chapter 2 - Python Agents + rclpy Integration",sidebar_label:"Python Agents + rclpy"},a="Chapter 2: Python Agents + rclpy Integration",o={},c=[{value:"Introduction to rclpy",id:"introduction-to-rclpy",level:2},{value:"Installing rclpy",id:"installing-rclpy",level:3},{value:"Connecting AI Agents to ROS Controllers",id:"connecting-ai-agents-to-ros-controllers",level:2},{value:"AI Agent Architecture",id:"ai-agent-architecture",level:3},{value:"Writing Publishers and Subscribers with rclpy",id:"writing-publishers-and-subscribers-with-rclpy",level:2},{value:"Minimal Publisher Example",id:"minimal-publisher-example",level:3},{value:"Minimal Subscriber Example",id:"minimal-subscriber-example",level:3},{value:"Integrating AI Algorithms",id:"integrating-ai-algorithms",level:2},{value:"Example: PID Controller as AI Agent",id:"example-pid-controller-as-ai-agent",level:3},{value:"Practical Examples",id:"practical-examples",level:2},{value:"Example 1: Simple Reflex Agent",id:"example-1-simple-reflex-agent",level:3},{value:"Example 2: Goal-Seeking Agent",id:"example-2-goal-seeking-agent",level:3},{value:"Exercises",id:"exercises",level:2}];function p(e){const n={code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",...(0,l.R)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(n.header,{children:(0,t.jsx)(n.h1,{id:"chapter-2-python-agents--rclpy-integration",children:"Chapter 2: Python Agents + rclpy Integration"})}),"\n",(0,t.jsx)(n.h2,{id:"introduction-to-rclpy",children:"Introduction to rclpy"}),"\n",(0,t.jsx)(n.p,{children:"rclpy is the Python client library for ROS 2. It provides the standard interface for Python programs to communicate with ROS 2. It allows Python programs to create ROS 2 nodes, publish and subscribe to topics, make service calls, provide services, and create action clients and servers."}),"\n",(0,t.jsx)(n.h3,{id:"installing-rclpy",children:"Installing rclpy"}),"\n",(0,t.jsx)(n.p,{children:"rclpy comes as part of the ROS 2 Python client libraries. To use it, you need to have ROS 2 installed on your system and source the ROS 2 environment:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"source /opt/ros/humble/setup.bash  # Replace 'humble' with your ROS 2 distribution\n"})}),"\n",(0,t.jsx)(n.h2,{id:"connecting-ai-agents-to-ros-controllers",children:"Connecting AI Agents to ROS Controllers"}),"\n",(0,t.jsx)(n.p,{children:"In this chapter, we'll explore how to connect Python-based AI agents to ROS controllers, bridging artificial intelligence with physical robot control. This integration allows AI algorithms to interact with robotic systems in real-time, enabling intelligent behaviors to be executed on real or simulated robots."}),"\n",(0,t.jsx)(n.h3,{id:"ai-agent-architecture",children:"AI Agent Architecture"}),"\n",(0,t.jsx)(n.p,{children:"A typical AI agent connected to ROS 2 would have the following components:"}),"\n",(0,t.jsxs)(n.ol,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Perception Layer"}),": Subscribes to sensor data topics"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Decision Making"}),": Processes sensor data and makes decisions"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Action Layer"}),": Publishes commands to robot controllers"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Communication Layer"}),": Manages ROS 2 node interfaces"]}),"\n"]}),"\n",(0,t.jsx)(n.h2,{id:"writing-publishers-and-subscribers-with-rclpy",children:"Writing Publishers and Subscribers with rclpy"}),"\n",(0,t.jsx)(n.h3,{id:"minimal-publisher-example",children:"Minimal Publisher Example"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-python",children:"import rclpy\nfrom rclpy.node import Node\nfrom std_msgs.msg import Float64MultiArray\nimport numpy as np\n\nclass AIPublisher(Node):\n    def __init__(self):\n        super().__init__('ai_publisher')\n\n        # Create publisher for motor commands\n        self.motor_cmd_publisher = self.create_publisher(\n            Float64MultiArray,\n            '/motor_commands',\n            10\n        )\n\n        # Timer to periodically send commands\n        self.timer = self.create_timer(0.1, self.publish_motor_commands)\n\n        # Simulated AI decision making\n        self.joint_angles = [0.0, 0.0, 0.0, 0.0]\n\n    def publish_motor_commands(self):\n        \"\"\"Publish motor commands based on AI decision\"\"\"\n        msg = Float64MultiArray()\n        msg.data = self.joint_angles\n\n        self.motor_cmd_publisher.publish(msg)\n        self.get_logger().info(f'Published motor commands: {msg.data}')\n\ndef main(args=None):\n    rclpy.init(args=args)\n\n    ai_publisher = AIPublisher()\n\n    try:\n        rclpy.spin(ai_publisher)\n    except KeyboardInterrupt:\n        pass\n    finally:\n        ai_publisher.destroy_node()\n        rclpy.shutdown()\n\nif __name__ == '__main__':\n    main()\n"})}),"\n",(0,t.jsx)(n.h3,{id:"minimal-subscriber-example",children:"Minimal Subscriber Example"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-python",children:"import rclpy\nfrom rclpy.node import Node\nfrom sensor_msgs.msg import JointState\nimport numpy as np\n\nclass AISubscriber(Node):\n    def __init__(self):\n        super().__init__('ai_subscriber')\n\n        # Create subscriber for sensor data\n        self.sensor_subscriber = self.create_subscription(\n            JointState,\n            '/joint_states',\n            self.sensor_callback,\n            10\n        )\n\n        self.latest_sensor_data = None\n\n    def sensor_callback(self, msg):\n        \"\"\"Process incoming sensor data\"\"\"\n        self.latest_sensor_data = {\n            'position': list(msg.position),\n            'velocity': list(msg.velocity),\n            'effort': list(msg.effort)\n        }\n\n        self.get_logger().info(f'Received sensor data: {len(msg.position)} joints')\n\ndef main(args=None):\n    rclpy.init(args=args)\n\n    ai_subscriber = AISubscriber()\n\n    try:\n        rclpy.spin(ai_subscriber)\n    except KeyboardInterrupt:\n        pass\n    finally:\n        ai_subscriber.destroy_node()\n        rclpy.shutdown()\n\nif __name__ == '__main__':\n    main()\n"})}),"\n",(0,t.jsx)(n.h2,{id:"integrating-ai-algorithms",children:"Integrating AI Algorithms"}),"\n",(0,t.jsx)(n.h3,{id:"example-pid-controller-as-ai-agent",children:"Example: PID Controller as AI Agent"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-python",children:'import rclpy\nfrom rclpy.node import Node\nfrom std_msgs.msg import Float64MultiArray\nfrom sensor_msgs.msg import JointState\nimport numpy as np\n\nclass PIDControllerAgent(Node):\n    def __init__(self):\n        super().__init__(\'pid_controller_agent\')\n\n        # Publishers and subscribers\n        self.cmd_publisher = self.create_publisher(Float64MultiArray, \'/motor_commands\', 10)\n        self.sensor_subscriber = self.create_subscription(\n            JointState, \'/joint_states\', self.sensor_callback, 10\n        )\n\n        # PID parameters\n        self.kp = 1.0\n        self.ki = 0.1\n        self.kd = 0.05\n        self.dt = 0.01  # Control loop time step\n\n        # PID state\n        self.error_prev = 0.0\n        self.integral = 0.0\n\n        # Target positions\n        self.target_positions = [1.0, 0.5, -0.5, 0.0]\n\n        # Control timer\n        self.control_timer = self.create_timer(self.dt, self.control_loop)\n\n        self.current_positions = [0.0, 0.0, 0.0, 0.0]\n\n    def sensor_callback(self, msg):\n        """Update current positions from sensor data"""\n        self.current_positions = list(msg.position)\n\n    def control_loop(self):\n        """Main control loop implementing PID algorithm"""\n        # Calculate errors\n        errors = [target - current for target, current in\n                  zip(self.target_positions, self.current_positions)]\n\n        # Proportional term\n        p_term = [self.kp * error for error in errors]\n\n        # Integral term\n        self.integral = [i + e * self.dt for i, e in zip(self.integral, errors)]\n        i_term = [self.ki * i for i in self.integral]\n\n        # Derivative term\n        derivative = [(e - ep) / self.dt for e, ep in zip(errors, self.error_prev)]\n        self.error_prev = errors\n        d_term = [self.kd * d for d in derivative]\n\n        # Calculate control output\n        control_output = [p + i + d for p, i, d in zip(p_term, i_term, d_term)]\n\n        # Publish commands\n        cmd_msg = Float64MultiArray()\n        cmd_msg.data = control_output\n        self.cmd_publisher.publish(cmd_msg)\n\ndef main(args=None):\n    rclpy.init(args=args)\n\n    controller_agent = PIDControllerAgent()\n\n    try:\n        rclpy.spin(controller_agent)\n    except KeyboardInterrupt:\n        pass\n    finally:\n        controller_agent.destroy_node()\n        rclpy.shutdown()\n\nif __name__ == \'__main__\':\n    main()\n'})}),"\n",(0,t.jsx)(n.h2,{id:"practical-examples",children:"Practical Examples"}),"\n",(0,t.jsx)(n.h3,{id:"example-1-simple-reflex-agent",children:"Example 1: Simple Reflex Agent"}),"\n",(0,t.jsx)(n.p,{children:"A reflex agent that responds directly to sensor inputs:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-python",children:"import rclpy\nfrom rclpy.node import Node\nfrom sensor_msgs.msg import LaserScan\nfrom geometry_msgs.msg import Twist\n\nclass ReflexAgent(Node):\n    def __init__(self):\n        super().__init__('reflex_agent')\n\n        # Publisher for robot velocity commands\n        self.cmd_vel_publisher = self.create_publisher(Twist, '/cmd_vel', 10)\n\n        # Subscriber for laser scan data\n        self.laser_subscriber = self.create_subscription(\n            LaserScan, '/scan', self.scan_callback, 10\n        )\n\n    def scan_callback(self, msg):\n        \"\"\"Simple obstacle avoidance reflex\"\"\"\n        min_distance = min(msg.ranges)\n\n        cmd = Twist()\n        if min_distance > 1.0:  # Safe distance\n            cmd.linear.x = 0.5   # Move forward\n            cmd.angular.z = 0.0  # Go straight\n        else:  # Obstacle detected\n            cmd.linear.x = 0.0   # Stop\n            cmd.angular.z = 0.5  # Turn\n\n        self.cmd_vel_publisher.publish(cmd)\n\ndef main(args=None):\n    rclpy.init(args=args)\n\n    reflex_agent = ReflexAgent()\n\n    try:\n        rclpy.spin(reflex_agent)\n    except KeyboardInterrupt:\n        pass\n    finally:\n        reflex_agent.destroy_node()\n        rclpy.shutdown()\n\nif __name__ == '__main__':\n    main()\n"})}),"\n",(0,t.jsx)(n.h3,{id:"example-2-goal-seeking-agent",children:"Example 2: Goal-Seeking Agent"}),"\n",(0,t.jsx)(n.p,{children:"An agent that navigates toward a goal while avoiding obstacles:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-python",children:"import rclpy\nfrom rclpy.node import Node\nfrom sensor_msgs.msg import LaserScan\nfrom geometry_msgs.msg import Twist, Point\nimport math\n\nclass GoalSeekingAgent(Node):\n    def __init__(self):\n        super().__init__('goal_seeking_agent')\n\n        self.cmd_vel_publisher = self.create_publisher(Twist, '/cmd_vel', 10)\n        self.laser_subscriber = self.create_subscription(\n            LaserScan, '/scan', self.scan_callback, 10\n        )\n\n        # Goal position\n        self.goal_x = 5.0\n        self.goal_y = 5.0\n\n        # Robot position (simplified)\n        self.robot_x = 0.0\n        self.robot_y = 0.0\n\n        # Control parameters\n        self.linear_speed = 0.5\n        self.angular_speed = 0.8\n        self.safe_distance = 0.5\n\n    def scan_callback(self, msg):\n        \"\"\"Process laser scan and navigate toward goal\"\"\"\n        # Simplified navigation logic\n        cmd = Twist()\n\n        # Calculate angle to goal\n        angle_to_goal = math.atan2(\n            self.goal_y - self.robot_y,\n            self.goal_x - self.robot_x\n        )\n\n        # Check for obstacles in front\n        front_scan = msg.ranges[len(msg.ranges)//2]  # Approximate front\n\n        if front_scan < self.safe_distance:\n            # Obstacle in front - turn away\n            cmd.linear.x = 0.0\n            cmd.angular.z = self.angular_speed\n        else:\n            # Move toward goal\n            cmd.linear.x = self.linear_speed\n            cmd.angular.z = angle_to_goal * 0.5  # Simple proportional control\n\n        self.cmd_vel_publisher.publish(cmd)\n\ndef main(args=None):\n    rclpy.init(args=args)\n\n    goal_agent = GoalSeekingAgent()\n\n    try:\n        rclpy.spin(goal_agent)\n    except KeyboardInterrupt:\n        pass\n    finally:\n        goal_agent.destroy_node()\n        rclpy.shutdown()\n\nif __name__ == '__main__':\n    main()\n"})}),"\n",(0,t.jsx)(n.h2,{id:"exercises",children:"Exercises"}),"\n",(0,t.jsxs)(n.ol,{children:["\n",(0,t.jsx)(n.li,{children:"Implement a neural network-based agent that learns to control a simple robot"}),"\n",(0,t.jsx)(n.li,{children:"Create an agent that coordinates multiple robot behaviors (navigation, manipulation, etc.)"}),"\n",(0,t.jsx)(n.li,{children:"Develop a reinforcement learning agent that learns optimal control policies for a humanoid robot"}),"\n"]})]})}function d(e={}){const{wrapper:n}={...(0,l.R)(),...e.components};return n?(0,t.jsx)(n,{...e,children:(0,t.jsx)(p,{...e})}):p(e)}},8453(e,n,r){r.d(n,{R:()=>i,x:()=>a});var s=r(6540);const t={},l=s.createContext(t);function i(e){const n=s.useContext(l);return s.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function a(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:i(e.components),s.createElement(l.Provider,{value:n},e.children)}}}]);